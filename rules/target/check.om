.PHONY: check

$(testresultdir):
  mkdir -p $@


public.testsuite (tag) =
  Name			= runtests
  Modules[]		= Runtests
  OCaml-Requires[]	= baselib

  private.RESULT	= $(testresultdir)/$(tag).rst

  target-common ()

  testsuite.rst: $(ocaml-program)
    $< $(rootdir) $(removeprefix $(fullname $(builddir)), $(fullname .))

  $(RESULT): testsuite.rst $(testresultdir)
    mv $< $@

  .DEFAULT: testsuite.rst
  check: $(RESULT)

  export
